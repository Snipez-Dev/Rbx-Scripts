
local VanithUI = {}

--// Services
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Stats = game:GetService("Stats")

--// Defaults
local DEFAULT_HUE = 0.55
local BASE_W, BASE_H = 650, 300
local TOP_H          = 28
local START_POS      = UDim2.new(0.15,0,0.2,20)

local COLOR_BG        = Color3.fromRGB(18,18,18)
local COLOR_PANEL     = Color3.fromRGB(25,25,25)
local COLOR_SIDEBAR   = Color3.fromRGB(15,15,15)
local COLOR_TEXT      = Color3.fromRGB(220,220,220)

--// Helpers
local function round(obj, r)
	local c = Instance.new("UICorner")
	c.CornerRadius = UDim.new(0, r or 4)
	c.Parent = obj
	return c
end

local function getParentGui()
	local ok, ui = pcall(function()
		local f = gethui and gethui()
		if typeof(f) == "Instance" then return f end
		return CoreGui
	end)
	return ok and ui or CoreGui
end

local function getPingMs()
	local ok, val = pcall(function()
		local item = Stats.Network.ServerStatsItem["Data Ping"]
		if not item then return nil end
		local s = item:GetValueString() -- "35 ms"
		local num = tonumber(string.match(s or "", "(%d+)"))
		return num
	end)
	if ok then return val end
	return nil
end

--// Components (tight spacing; no extra spacer frames)
local Component = {}

function Component.Label(container, text, accent)
	local lbl = Instance.new("TextLabel")
	lbl.BackgroundTransparency = 1
	lbl.Font = Enum.Font.Gotham
	lbl.TextSize = 14
	lbl.TextColor3 = accent or COLOR_TEXT
	lbl.TextXAlignment = Enum.TextXAlignment.Left
	lbl.Text = text or ""
	lbl.Size = UDim2.new(1, -20, 0, 20)
	lbl.Position = UDim2.new(0, 10, 0, 0)
	lbl.Parent = container
	return lbl
end

function Component.Button(container, text, accent, callback)
	local btn = Instance.new("TextButton")
	btn.AutoButtonColor = true
	btn.Text = text or "Button"
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 16
	btn.TextColor3 = accent
	btn.BackgroundColor3 = COLOR_SIDEBAR
	btn.Size = UDim2.new(1, -20, 0, 30)
	btn.Position = UDim2.new(0, 10, 0, 0)
	round(btn, 6)
	btn.Parent = container
	btn.MouseButton1Click:Connect(function()
		if typeof(callback) == "function" then task.spawn(callback) end
	end)
	return btn
end

function Component.Toggle(container, text, accent, default, callback)
	local h = 30
	local frame = Instance.new("Frame")
	frame.BackgroundColor3 = COLOR_SIDEBAR
	frame.Size = UDim2.new(1,-20,0,h)
	frame.Position = UDim2.new(0,10,0,0)
	frame.BorderSizePixel = 0
	round(frame, 6)
	frame.Parent = container

	local box = Instance.new("TextButton")
	box.AutoButtonColor = false
	box.Text = ""
	box.Size = UDim2.new(0,24,0,24)
	box.Position = UDim2.new(1,-30,0,(h-24)/2)
	box.BackgroundColor3 = (default and accent) or COLOR_BG
	round(box,4)
	box.Parent = frame

	local mark = Instance.new("Frame")
	mark.Size = UDim2.new(1,0,1,0)
	mark.BackgroundColor3 = COLOR_BG
	mark.BackgroundTransparency = default and 1 or 0
	round(mark,4)
	mark.Parent = box

	local lbl = Instance.new("TextLabel")
	lbl.BackgroundTransparency = 1
	lbl.Text = text or "Toggle"
	lbl.Font = Enum.Font.Gotham
	lbl.TextSize = 14
	lbl.TextColor3 = accent
	lbl.TextXAlignment = Enum.TextXAlignment.Left
	lbl.Size = UDim2.new(1,-38,1,0)
	lbl.Position = UDim2.new(0,8,0,0)
	lbl.Parent = frame

	local state = not not default
	local function set(v)
		state = not not v
		box.BackgroundColor3 = state and accent or COLOR_BG
		mark.BackgroundTransparency = state and 1 or 0
		if typeof(callback) == "function" then callback(state) end
	end
	box.MouseButton1Click:Connect(function() set(not state) end)

	return { Instance = frame, Set = set, Get = function() return state end }
end

function Component.Slider(container, text, accent, min, max, default, callback)
	min, max = min or 0, max or 100
	if default == nil then default = min end

	local frame = Instance.new("Frame")
	frame.BackgroundColor3 = COLOR_SIDEBAR
	frame.Size = UDim2.new(1,-20,0,40)
	frame.Position = UDim2.new(0,10,0,0)
	frame.BorderSizePixel = 0
	round(frame, 6)
	frame.Parent = container

	local lbl = Instance.new("TextLabel")
	lbl.BackgroundTransparency = 1
	lbl.Text = string.format("%s: %s", text or "Slider", tostring(default))
	lbl.Font = Enum.Font.Gotham
	lbl.TextSize = 14
	lbl.TextColor3 = accent
	lbl.TextXAlignment = Enum.TextXAlignment.Left
	lbl.Size = UDim2.new(1,-20,0,18)
	lbl.Position = UDim2.new(0,10,0,6)
	lbl.Parent = frame

	local bar = Instance.new("Frame")
	bar.BackgroundColor3 = COLOR_BG
	bar.BorderSizePixel = 0
	bar.Position = UDim2.new(0,10,0,26)
	bar.Size = UDim2.new(1,-20,0,8)
	round(bar, 4)
	bar.Parent = frame

	local fill = Instance.new("Frame")
	fill.BackgroundColor3 = accent
	fill.BorderSizePixel = 0
	fill.Size = UDim2.new((default-min)/(max-min),0,1,0)
	round(fill, 4)
	fill.Parent = bar

	local dragging, value = false, default
	local function setFromX(x)
		local rel = math.clamp((x - bar.AbsolutePosition.X) / (bar.AbsoluteSize.X), 0, 1)
		value = math.floor(min + (max - min)*rel + 0.5)
		fill.Size = UDim2.new(rel, 0, 1, 0)
		lbl.Text = string.format("%s: %s", text or "Slider", tostring(value))
		if typeof(callback) == "function" then callback(value) end
	end
	bar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			setFromX(input.Position.X)
		end
	end)
	bar.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
			setFromX(input.Position.X)
		end
	end)

	return {
		Instance = frame,
		Set = function(v)
			v = math.clamp(v, min, max)
			local rel = (v-min)/(max-min)
			fill.Size = UDim2.new(rel, 0, 1, 0)
			lbl.Text = string.format("%s: %s", text or "Slider", tostring(v))
			value = v
			if typeof(callback)=="function" then callback(value) end
		end,
		Get = function() return value end
	}
end

--// CreateWindow (exact main + sidebar tabs)
function VanithUI.CreateWindow(opts)
	opts = opts or {}
	local width  = opts.Width  or BASE_W
	local height = opts.Height or BASE_H
	local hue    = (opts.Hue ~= nil) and opts.Hue or DEFAULT_HUE
	local accent = Color3.fromHSV(hue,1,1)
	local title  = opts.Title or "Vanith | Eternal Nights"
	local version= opts.Version or "v1.0.2"
	local onDiscord   = opts.OnDiscord   or function() end
	local onUnlockFPS = opts.OnUnlockFPS or function() end

	-- Root
	local root = Instance.new("ScreenGui")
	root.Name = "VanithUI_Exact_v2"
	root.ResetOnSpawn = false
	root.IgnoreGuiInset = true
	root.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	root.Parent = getParentGui()

	-- Main window
	local main = Instance.new("Frame")
	main.Size = UDim2.new(0,width,0,height)
	main.Position = START_POS
	main.BackgroundColor3 = COLOR_BG
	main.BorderSizePixel = 0
	round(main,6)
	main.Parent = root

	-- Top bar
	local topBar = Instance.new("Frame")
	topBar.Size = UDim2.new(1,0,0,TOP_H)
	topBar.BackgroundTransparency = 1
	topBar.Parent = main

	local titleLbl = Instance.new("TextLabel")
	titleLbl.Text = title
	titleLbl.Font = Enum.Font.GothamBold
	titleLbl.TextSize = 16
	titleLbl.TextColor3 = accent
	titleLbl.BackgroundTransparency = 1
	titleLbl.Position = UDim2.new(0,-60,0,0) -- exact offset like original
	titleLbl.Size = UDim2.new(0,300,1,0)
	titleLbl.TextXAlignment = Enum.TextXAlignment.Left
	titleLbl.Parent = topBar

	local btnMin = Instance.new("TextButton")
	btnMin.Text = "_"
	btnMin.Font = Enum.Font.GothamBold
	btnMin.TextSize = 20
	btnMin.TextColor3 = accent
	btnMin.BackgroundTransparency = 1
	btnMin.Size = UDim2.new(0,28,0,TOP_H)
	btnMin.Position = UDim2.new(1,-60,0,0)
	btnMin.Parent = topBar

	local btnClose = Instance.new("TextButton")
	btnClose.Text = "X"
	btnClose.Font = Enum.Font.GothamBold
	btnClose.TextSize = 18
	btnClose.TextColor3 = accent
	btnClose.BackgroundTransparency = 1
	btnClose.Size = UDim2.new(0,28,0,TOP_H)
	btnClose.Position = UDim2.new(1,-32,0,0)
	btnClose.Parent = topBar

	-- Drag
	do
		local dragging, dragInput, dragStart, startPos
		topBar.InputBegan:Connect(function(i)
			if i.UserInputType==Enum.UserInputType.MouseButton1 then
				dragging, dragStart, startPos = true, i.Position, main.Position
				i.Changed:Connect(function()
					if i.UserInputState==Enum.UserInputState.End then dragging=false end
				end)
			end
		end)
		topBar.InputChanged:Connect(function(i)
			if i.UserInputType==Enum.UserInputType.MouseMovement then dragInput = i end
		end)
		UserInputService.InputChanged:Connect(function(i)
			if dragging and i==dragInput then
				local delta = i.Position - dragStart
				main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
			end
		end)
	end

	-- Minimize
	local minimized, miniFrame = false, nil
	btnMin.MouseButton1Click:Connect(function()
		if not minimized then
			minimized = true
			main.Visible = false
			miniFrame = Instance.new("Frame")
			miniFrame.Name = "Mini ❄️"
			miniFrame.Size = UDim2.new(0,50,0,50)
			miniFrame.Position = START_POS
			miniFrame.BackgroundColor3 = COLOR_BG
			miniFrame.BorderSizePixel = 0
			round(miniFrame,4)
			miniFrame.Parent = root

			local icon = Instance.new("TextLabel")
			icon.Text = "❄️"
			icon.Font = Enum.Font.GothamBold
			icon.TextSize = 28
			icon.TextColor3 = accent
			icon.BackgroundTransparency = 1
			icon.Size = UDim2.new(1,0,1,0)
			icon.TextXAlignment = Enum.TextXAlignment.Center
			icon.TextYAlignment = Enum.TextYAlignment.Center
			icon.Parent = miniFrame

			local dragging, dragInput, dragStart, startPos, moved = false, nil, nil, nil, false
			miniFrame.InputBegan:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 then
					dragging = true; moved = false
					dragStart = input.Position; startPos = miniFrame.Position
					input.Changed:Connect(function()
						if input.UserInputState == Enum.UserInputState.End then dragging = false end
					end)
				end
			end)
			miniFrame.InputChanged:Connect(function(input)
				if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
					local delta = input.Position - dragStart
					if not moved and (math.abs(delta.X)>5 or math.abs(delta.Y)>5) then moved = true end
					miniFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
				end
			end)
			miniFrame.InputEnded:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 then
					if not moved then
						minimized = false
						miniFrame:Destroy()
						main.Visible = true
						btnMin.Text = "_"
					end
				end
			end)

			btnMin.Text = "⬆"
		else
			minimized = false
			if miniFrame then miniFrame:Destroy() end
			main.Visible = true
			btnMin.Text = "_"
		end
	end)

	-- Close
	btnClose.MouseButton1Click:Connect(function() root:Destroy() end)

	-- Sidebar + Content
	local sidebar = Instance.new("Frame")
	sidebar.Size = UDim2.new(0,100,1,-TOP_H)
	sidebar.Position = UDim2.new(0,0,0,TOP_H)
	sidebar.BackgroundColor3 = COLOR_SIDEBAR
	sidebar.BorderSizePixel = 0
	round(sidebar,4)
	sidebar.Parent = main

	local content = Instance.new("Frame")
	content.Size = UDim2.new(1,-100,1,-TOP_H)
	content.Position = UDim2.new(0,100,0,TOP_H)
	content.BackgroundColor3 = COLOR_PANEL
	content.BorderSizePixel = 0
	round(content,4)
	content.Parent = main

	-- Tabs
	local pages, scrolls, tabButtons, order = {}, {}, {}, {}
	local activeTab = "Main"
	local function showPage(name)
		activeTab = name
		for t,p in pairs(pages) do p.Visible = (t==name) end
		for t,b in pairs(tabButtons) do b.TextColor3 = (t==name) and accent or COLOR_TEXT end
	end

	local function createTabButton(name, index)
		local b = Instance.new("TextButton")
		b.Name = name.."Tab"
		b.Text = name
		b.Font = Enum.Font.Gotham
		b.TextSize = 16
		b.TextColor3 = (name==activeTab) and accent or COLOR_TEXT
		b.BackgroundTransparency = 1
		b.Size = UDim2.new(1,0,0,32)
		b.Position = UDim2.new(0,0,0,(index-1)*36) -- same spacing
		b.Parent = sidebar
		b.MouseButton1Click:Connect(function() showPage(name) end)
		tabButtons[name] = b
		return b
	end

	local function createPage(name)
		local p = Instance.new("Frame")
		p.Name = name.."Page"
		p.Size = UDim2.new(1,0,1,0)
		p.BackgroundTransparency = 1
		p.Visible = (name==activeTab)
		p.Parent = content

		local scroll = Instance.new("ScrollingFrame")
		scroll.Size = UDim2.new(1,0,1,0)
		scroll.BackgroundTransparency = 1
		scroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
		scroll.CanvasSize = UDim2.new(0,0,0,0)
		scroll.Parent = p

		if name == "Main" then
			scroll.ScrollingEnabled = false
			scroll.ScrollBarThickness = 0
			scroll.ScrollBarImageTransparency = 1
		else
			scroll.ScrollingEnabled = true
			scroll.ScrollBarThickness = 0
			scroll.ScrollBarImageTransparency = 1

			local pad = Instance.new("UIPadding")
			pad.PaddingLeft = UDim.new(0,12)
			pad.PaddingTop = UDim.new(0,12)
			pad.PaddingRight = UDim.new(0,12)
			pad.PaddingBottom = UDim.new(0,12)
			pad.Parent = scroll

			local list = Instance.new("UIListLayout")
			list.SortOrder = Enum.SortOrder.LayoutOrder
			list.Padding = UDim.new(0,8) -- tighter spacing
			list.Parent = scroll
		end

		pages[name], scrolls[name] = p, scroll
		return p, scroll
	end

	local function addTab(name)
		if pages[name] then return end
		table.insert(order, name)
		createTabButton(name, #order)
		createPage(name)
	end

	-- Default tabs
	addTab("Main")
	addTab("ESP")
	addTab("Misc")
	addTab("Teleport")

	-- Build Main (exact) + dynamic metrics
	local changelogLabel, changelogButton
	do
		local pad = 16
		local scroll = scrolls.Main

		local left = Instance.new("Frame")
		left.Size = UDim2.new(0,300,0,110)
		left.Position = UDim2.new(0,pad,0,pad)
		left.BackgroundColor3 = COLOR_SIDEBAR
		left.BorderSizePixel = 0
		round(left,8)
		left.Parent = scroll

		local avatar = Instance.new("ImageLabel")
		avatar.Size = UDim2.new(0,64,0,64)
		avatar.Position = UDim2.new(0,16,0,16)
		avatar.BackgroundTransparency = 1
		round(avatar,32)
		avatar.Parent = left
		task.spawn(function()
			local p = Players.LocalPlayer
			local img = Players:GetUserThumbnailAsync(p.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
			avatar.Image = img
		end)

		-- Name+Version in eigener Column (fix position/alignment)
		local infoCol = Instance.new("Frame")
		infoCol.BackgroundTransparency = 1
		infoCol.Position = UDim2.new(0, 96, 0, 12) -- closer to avatar, slightly lower
		infoCol.Size = UDim2.new(1, -110, 1, -24) -- fill remaining width with padding
		infoCol.Parent = left

		local nameLbl = Instance.new("TextLabel")
		nameLbl.Text = Players.LocalPlayer.Name
		nameLbl.Font = Enum.Font.GothamBold
		nameLbl.TextSize = 20
		nameLbl.TextColor3 = accent
		nameLbl.BackgroundTransparency = 1
		nameLbl.TextXAlignment = Enum.TextXAlignment.Left
		nameLbl.Size = UDim2.new(1, 0, 0, 24)
		nameLbl.Position = UDim2.new(0, 0, 0, 4)
		nameLbl.Parent = infoCol

		local verLbl = Instance.new("TextLabel")
		verLbl.Text = "Version: "..tostring(version)
		verLbl.Font = Enum.Font.Gotham
		verLbl.TextSize = 14
		verLbl.TextColor3 = accent
		verLbl.BackgroundTransparency = 1
		verLbl.TextXAlignment = Enum.TextXAlignment.Left
		verLbl.Size = UDim2.new(1, 0, 0, 18)
		verLbl.Position = UDim2.new(0, 0, 0, 28)
		verLbl.Parent = infoCol

		local joinBtn = Instance.new("TextButton")
		joinBtn.Text = "Join Discord"
		joinBtn.Font = Enum.Font.GothamBold
		joinBtn.TextSize = 16
		joinBtn.TextColor3 = accent
		joinBtn.BackgroundColor3 = COLOR_SIDEBAR
		joinBtn.Size = UDim2.new(0, 160, 0, 28)
		joinBtn.Position = UDim2.new(0, 0, 0, 52)
		round(joinBtn,6)
		joinBtn.Parent = infoCol
		joinBtn.MouseButton1Click:Connect(function() onDiscord() end)

		local right = Instance.new("Frame")
		right.Size = UDim2.new(0,200,0,110)
		right.Position = UDim2.new(1,-(200+pad),0,pad)
		right.BackgroundColor3 = COLOR_SIDEBAR
		right.BorderSizePixel = 0
		round(right,8)
		right.Parent = scroll

		local fpsLbl = Instance.new("TextLabel")
		fpsLbl.Text = "FPS: —"
		fpsLbl.Font = Enum.Font.Gotham
		fpsLbl.TextSize = 16
		fpsLbl.TextColor3 = accent
		fpsLbl.BackgroundTransparency = 1
		fpsLbl.Position = UDim2.new(0,8,0,18)
		fpsLbl.Size = UDim2.new(1,-16,0,20)
		fpsLbl.TextXAlignment = Enum.TextXAlignment.Left
		fpsLbl.Parent = right

		local pingLbl = fpsLbl:Clone()
		pingLbl.Text = "Ping: —"
		pingLbl.Position = UDim2.new(0,8,0,44)
		pingLbl.Parent = right

		local unlockBtn = Instance.new("TextButton")
		unlockBtn.Text = "Unlock FPS"
		unlockBtn.Font = Enum.Font.GothamBold
		unlockBtn.TextSize = 16
		unlockBtn.TextColor3 = accent
		unlockBtn.BackgroundColor3 = COLOR_SIDEBAR
		unlockBtn.Size = UDim2.new(1,-16,0,28)
		unlockBtn.Position = UDim2.new(0,8,0,74)
		round(unlockBtn,6)
		unlockBtn.Parent = right
		unlockBtn.MouseButton1Click:Connect(function() onUnlockFPS() end)

		-- Changelog card with API-accessible label + optional button
		local logCard = Instance.new("Frame")
		logCard.BackgroundColor3 = COLOR_SIDEBAR
		logCard.BorderSizePixel = 0
		logCard.Position = UDim2.new(0,pad,0, 110 + pad*2)
		logCard.Size = UDim2.new(1,-pad*2,0,120)
		round(logCard,8)
		logCard.Parent = scroll

		changelogLabel = Instance.new("TextLabel")
		changelogLabel.Font = Enum.Font.Gotham
		changelogLabel.TextSize = 14
		changelogLabel.TextColor3 = accent
		changelogLabel.BackgroundTransparency = 1
		changelogLabel.TextXAlignment = Enum.TextXAlignment.Left
		changelogLabel.TextYAlignment = Enum.TextYAlignment.Top
		changelogLabel.TextWrapped = true
		changelogLabel.Text = table.concat({
			"Changelog (UI Skeleton):",
			"- Frost-style window + tabs",
			"- Minimize/Close + Drag",
			"- Notification system",
			"- Empty ESP/Misc/Teleport pages",
		}, "\n")
		changelogLabel.Position = UDim2.new(0,12,0,10)
		changelogLabel.Size = UDim2.new(1,-24,1,-20)
		changelogLabel.Parent = logCard

		changelogButton = Instance.new("TextButton")
		changelogButton.Text = ""
		changelogButton.Visible = false -- only shown when set via API
		changelogButton.Font = Enum.Font.GothamBold
		changelogButton.TextSize = 14
		changelogButton.TextColor3 = accent
		changelogButton.BackgroundColor3 = COLOR_SIDEBAR
		changelogButton.Size = UDim2.new(0,130,0,26)
		changelogButton.Position = UDim2.new(1,-(130+12),0,8)
		round(changelogButton,6)
		changelogButton.Parent = logCard

		-- dynamic updates
		local fpsSmoothed, last = 60, tick()
		RunService.Heartbeat:Connect(function()
			local now = tick()
			local dt = now - last
			last = now
			if dt > 0 then
				local inst = 1/dt
				fpsSmoothed = fpsSmoothed * 0.9 + inst * 0.1
				fpsLbl.Text = ("FPS: %d"):format(math.floor(fpsSmoothed + 0.5))
			end
		end)
		task.spawn(function()
			while root.Parent do
				local p = getPingMs()
				pingLbl.Text = p and ("Ping: %d ms"):format(p) or "Ping: —"
				task.wait(0.5)
			end
		end)
	end

	-- Public API
	local tabs = {}
	local function makeTabObj(name)
		local scroll = scrolls[name]
		local Tab = {}
		function Tab:AddLabel(text) return Component.Label(scroll, text, accent) end
		function Tab:AddButton(text, cb) return Component.Button(scroll, text, accent, cb) end
		function Tab:AddToggle(text, def, cb) return Component.Toggle(scroll, text, accent, def, cb) end
		function Tab:AddSlider(text, mi, ma, de, cb) return Component.Slider(scroll, text, accent, mi, ma, de, cb) end
		function Tab:GetContainer() return scroll end
		function Tab:GetName() return name end
		tabs[name] = Tab
		return Tab
	end
	for _,n in ipairs({"Main","ESP","Misc","Teleport"}) do makeTabObj(n) end

	local window = {}
	function window:ShowTab(name) if pages[name] then showPage(name) end end
	function window:GetTab(name) return tabs[name] end
	function window:CreateTab(name)
		if pages[name] then return tabs[name] end
		addTab(name); makeTabObj(name); showPage(name); return tabs[name]
	end
	function window:SetHue(h)
		h = tonumber(h) or DEFAULT_HUE
		h = math.clamp(h, 0, 1)
		local acc = Color3.fromHSV(h,1,1)
		accent = acc
		-- recolor top highlights and changelog button
		titleLbl.TextColor3 = acc
		btnMin.TextColor3 = acc
		btnClose.TextColor3 = acc
		if changelogButton then changelogButton.TextColor3 = acc end
		-- recolor active tab text
		for n,b in pairs(tabButtons) do b.TextColor3 = (n==activeTab) and acc or COLOR_TEXT end
	end
	function window:SetTitle(t) titleLbl.Text = tostring(t or "") end
	function window:SetChangelog(text)
		if changelogLabel then
			changelogLabel.Text = tostring(text or "")
		end
	end
	function window:SetChangelogButton(label, callback)
		if changelogButton then
			changelogButton.Text = tostring(label or "")
			changelogButton.Visible = (changelogButton.Text ~= "")
			changelogButton.MouseButton1Click:Connect(function()
				if typeof(callback) == "function" then callback() end
			end)
		end
	end
	function window:GetRoot() return root end
	function window:Destroy() root:Destroy() end

	-- Toggle with M
	UserInputService.InputBegan:Connect(function(i, g)
		if not g and i.KeyCode == Enum.KeyCode.M then
			root.Enabled = not root.Enabled
		end
	end)

	-- Initial
	showPage("Main")
	return window
end

return VanithUI
