IceHubLib = {}

function IceHubLib.Init(title)
    local Library = {} -- Speichert alle Tabs und Elemente
    Library.MainUI = Instance.new("ScreenGui")
    Library.MainUI.Parent = game.CoreGui
    
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(0, 400, 0, 300)
    Frame.Position = UDim2.new(0.5, -200, 0.5, -150)
    Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Frame.Parent = Library.MainUI

    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(1, 0, 0, 30)
    TitleLabel.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    TitleLabel.TextColor3 = Color3.fromRGB(0, 255, 255)
    TitleLabel.Text = title
    TitleLabel.Parent = Frame

    Library.Frame = Frame
    Library.Tabs = {}

    return Library
end

function IceHubLib.CreateTab(library, name)
    local Tab = {}
    Tab.Frame = Instance.new("Frame")
    Tab.Frame.Size = UDim2.new(1, 0, 1, -30)
    Tab.Frame.Position = UDim2.new(0, 0, 0, 30)
    Tab.Frame.BackgroundTransparency = 1
    Tab.Frame.Visible = false
    Tab.Frame.Parent = library.Frame

    local Button = Instance.new("TextButton")
    Button.Size = UDim2.new(0, 100, 0, 30)
    Button.Text = name
    Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Button.TextColor3 = Color3.fromRGB(0, 255, 255)
    Button.Parent = library.Frame
    Button.Position = UDim2.new(#library.Tabs * 0.25, 0, 0, 0)

    Button.MouseButton1Click:Connect(function()
        for _, v in pairs(library.Tabs) do
            v.Frame.Visible = false
        end
        Tab.Frame.Visible = true
    end)

    library.Tabs[#library.Tabs + 1] = Tab
    return Tab
end

function IceHubLib.CreateButton(tab, text, callback)
    local Button = Instance.new("TextButton")
    Button.Size = UDim2.new(1, -10, 0, 30)
    Button.Position = UDim2.new(0, 5, 0, (#tab.Frame:GetChildren() - 1) * 35)
    Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.Text = text
    Button.Parent = tab.Frame

    Button.MouseButton1Click:Connect(function()
        callback()
    end)
end

function IceHubLib.CreateBox(tab, placeholder, callback)
    local Box = Instance.new("TextBox")
    Box.Size = UDim2.new(1, -10, 0, 30)
    Box.Position = UDim2.new(0, 5, 0, (#tab.Frame:GetChildren() - 1) * 35)
    Box.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Box.TextColor3 = Color3.fromRGB(255, 255, 255)
    Box.PlaceholderText = placeholder
    Box.Parent = tab.Frame

    Box.FocusLost:Connect(function(enterPressed)
        if enterPressed then
            callback(Box.Text)
        end
    end)
end

function IceHubLib.CreateSlider(tab, text, min, max, default, callback)
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(1, -10, 0, 50)
    Frame.Position = UDim2.new(0, 5, 0, (#tab.Frame:GetChildren() - 1) * 55)
    Frame.Parent = tab.Frame

    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(1, 0, 0, 20)
    Label.Text = text .. ": " .. default
    Label.TextColor3 = Color3.fromRGB(255, 255, 255)
    Label.Parent = Frame

    local Slider = Instance.new("Slider")
    Slider.Size = UDim2.new(1, 0, 0, 30)
    Slider.Position = UDim2.new(0, 0, 0, 20)
    Slider.MinValue = min
    Slider.MaxValue = max
    Slider.Value = default
    Slider.Parent = Frame

    Slider.Changed:Connect(function(value)
        Label.Text = text .. ": " .. math.floor(value)
        callback(value)
    end)
end

function IceHubLib.CreateDropdown(tab, text, options, callback)
    local Dropdown = Instance.new("TextButton")
    Dropdown.Size = UDim2.new(1, -10, 0, 30)
    Dropdown.Position = UDim2.new(0, 5, 0, (#tab.Frame:GetChildren() - 1) * 35)
    Dropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Dropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
    Dropdown.Text = text
    Dropdown.Parent = tab.Frame

    local Menu = Instance.new("Frame")
    Menu.Size = UDim2.new(1, 0, 0, #options * 30)
    Menu.Visible = false
    Menu.Parent = Dropdown

    for i, option in pairs(options) do
        local Button = Instance.new("TextButton")
        Button.Size = UDim2.new(1, 0, 0, 30)
        Button.Text = option
        Button.Parent = Menu

        Button.MouseButton1Click:Connect(function()
            Dropdown.Text = text .. ": " .. option
            Menu.Visible = false
            callback(option)
        end)
    end

    Dropdown.MouseButton1Click:Connect(function()
        Menu.Visible = not Menu.Visible
    end)
end
